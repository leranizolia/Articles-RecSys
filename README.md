# Articles-RecSys

Задача и метрика:

Работа с логами рекомендательной системы, где для пользователей даны их сессии — документы, которые им были показаны, и реакция на них (клик или его отсутствие). Также для каждого документа известны его заголовок, содержание и уже подготовленный эмбеддинг для картинки из него. Для каждого пользователя дан тестовый набор документов — нужно для каждого из них предсказать, будет ли сделан клик или нет.

Качество рекомендаций оценивается по NDCG@20. 

Описание данных:

tems.json:

itemId - ID публикации
title - заголовок (текст)
content - содержимое (текст)
image - CNN эмбеддинг картинки (вектор)
Пример:

{"content": "Согласитесь...", "itemId": 0, "image": [-0.169, ...], "title": "Пять..."} {"content": " Контуры...", "itemId": 1, "image": [-0.158, ...], "title": "История..."}

train.json:

userId - ID юзера
trainRatings - словарь с оценками вида {itemId: 1 if click, 0 otherwise}; оценка 0 означает, что пользователю был показан данный документ, но клика не было.

Модель и особенности решения:

На самом деле, несмотря на сложность задачи на первый взгляд, достойное качество модели показала lightfm (https://making.lyst.com/lightfm/docs/home.html). Предварительно текст (заголовки и контент) были векторизированы с помощью TfidfVectorizer. Интересно отметить, что картинки только незначительно влияли на качество, при этом время обучения модели увеличивалось в разы. Модель была обучалась в google colab с ограничением времени 12 часов, поэтому при выборе большего числа эпох vs добавление картинок в модель - выиграл первый вариант. Ещё одним интересным моментом стала проблема памяти, для решения которой были использованы sparse matrix. Таким образом, несмотря на, казалось бы, небольшой ноутбук с lightfm из коробки, много времени ушло на то, чтобы разобраться с проблемами памяти и времени.

Итоговое качество получилось около 0.2 - относительно достойный результат. 
